<!doctype HTML>
<html lang="en">
<head>
    <title>How to analyze California campaign cash in the cloud with Apache Spark and Databricks</title>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" type="image/png" href="//www.californiacivicdata.org/favicon.png">

<link type="text/css" rel="stylesheet" href="/css/bootstrap.min.css">

<link rel="stylesheet" type="text/css" href="//calaccess.californiacivicdata.org/static/calaccess_website/css/sourcesanspro.css">
<link rel="stylesheet" type="text/css" href="//calaccess.californiacivicdata.org/static/calaccess_website/css/main.css?foobar">

<link type="text/css" rel="stylesheet" href="/css/font-awesome.min.css">
<link href="//fonts.googleapis.com/css?family=Raleway:400,600" rel="stylesheet">
<link type="text/css" rel="stylesheet" href="/css/blog.css">

<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.js"></script>
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55129934-1', 'auto');
  ga('send', 'pageview');

</script>

    <meta name="date" content="2016-10-24 00:00:00 +0000" />

    <meta property="og:site_name" content="www.californiacivicdata.org"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="How to analyze California campaign cash in the cloud with Apache Spark and Databricks"/>
    <meta property="og:image" content="http://www.californiacivicdata.org/img/databricks-promo.png"/>
    <meta property="og:description" content="Use the Coalition's API to run SQL queries across millions of records from the comfort of your browser"/>

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:image:src" content="http://www.californiacivicdata.org/img/databricks-promo.png">
    <meta property="twitter:site" content="@latimes">
    <meta property="twitter:title" content="How to analyze California campaign cash in the cloud with Apache Spark and Databricks">
    <meta property="twitter:description" content="Use the Coalition's API to run SQL queries across millions of records from the comfort of your browser"/>
    <meta property="twitter:image" content="http://www.californiacivicdata.org/img/databricks-promo.png" />
    <link rel="image_src" type="image/jpeg" href="http://www.californiacivicdata.org/img/databricks-promo.png" />
</head>
<body>
    <header>
  <nav class="container">
    <div class="row">
    <div class="col-md-12">
      <ul class="nav nav-pills">
        <li class="visible-lg-inline visible-md-inline visible-sm-inline invisible-xs-inline" style="margin-left:0;">
            <a class="logo" href="https://www.californiacivicdata.org/">
                <img
                    src="//calaccess.californiacivicdata.org/static/calaccess_website/images/brown-geobear.svg"
                    alt="California Civic Data Coalition logo"
                    title="Home"
                >
            </a>
        </li>
        <li id="home"><a href="/">HOME</a></li>
        <li id="data"><a href="https://calaccess.californiacivicdata.org/downloads/latest/">DATA</a></li>
        <li id="docs"><a href="https://calaccess.californiacivicdata.org/documentation/">DOCS</a></li>
        <li id="blog"><a href="/archive/">BLOG</a></li>
        <li id="about"><a href="/about/">ABOUT</a></li>
      </ul>
    </div>
    </div>
  </nav>
</header>

<script type="text/javascript">
    var url = window.location;
    // Will only work if string in href matches with location
    $('ul.nav a[href="' + url + '"]').parent().addClass('active');
    // Will also work for relative and absolute hrefs
    $('ul.nav a').filter(function() {
        return this.href == url;
    }).parent().addClass('active');
    $("#small-icon").css("cursor", "pointer");
    $("#small-icon").click(function () {
        window.location = '/';
    });
</script>

    <article>
    <div class="bg-red">
        <div class="container">
            <div class="row">
                <nav class="col-md-9">
                    <ol class="breadcrumb">
                        <li><a href="/">Home</a></li>
                        <li><a href="/archive/">Blog</a></li>
                    </ol>
                </nav>
                <div class="col-md-9">
                    <h1>How to analyze California campaign cash in the cloud with Apache Spark and Databricks</h1>
                    <p>
                        <p>Use the Coalition’s API to run SQL queries across millions of records from the comfort of your browser</p>

                    </p>
                    <div class="byline"><p>By <a href="http://billchambers.me/about.html">Bill Chambers</a></p>
</div>
                <div class="pubdate"><p><time datetime="2016-10-24">October 24, 2016</time></p></div>
                </div>
            </div>
        </div>
    </div>
    <div class="container content">
        <div class="row">
            <div class="post col-lg-8 col-md-10 col-sm-12 col-xs-12">
                <p><em>Editor’s note: This post was written (and submitted without pay <a href="https://github.com/california-civic-data-coalition/california-civic-data-coalition.github.io/pull/15">via pull request</a>) by a volunteer to our open-source project who is also a Databricks employee.</em></p>

<figure style="margin: 8px 0 0 18px; float:right;">
   <a href="http://billchambers.me/about.html">
    <img src="/img/bill-chambers.jpg" height="150" alt="Bill Chambers" style="float:right; clear:both;" title="Bill Chambers" />
   </a>
   <figcaption style="float:left; clear:both;">Bill Chambers</figcaption>
</figure>

<p>As a <a href="http://www.californiacivicdata.org/2014/11/24/postgres-support/">past contributor</a> to the California Civic Data Coalition I’ve been really pleased with how much the project has progressed. It’s amazing to see the state’s <a href="http://calaccess.californiacivicdata.org/downloads/latest/">campaign finance and lobbying activity data</a> in a simple, clean format that users can immediately work with.</p>

<p>However, with <a href="http://calaccess.californiacivicdata.org/documentation/calaccess-files/smry-cd/">some</a> <a href="http://calaccess.californiacivicdata.org/documentation/calaccess-files/expn-cd/">tables</a> stacking up millions of rows, the data are often too big for standard tools like Microsoft Excel spreadsheets.</p>

<p>The result is that most beginners will need to install a series of complicated computer programming tools before they can begin any analysis.</p>

<p>In my experience teaching at <a href="https://www.ischool.berkeley.edu/courses/info/018">UC Berkeley</a> and on <a href="https://www.udemy.com/data-analysis-in-python-with-pandas/">Udemy</a>, I’ve observed students often get caught up installing that kind software on their machines, which hinders their introduction to our field.</p>

<h3 id="the-databricks-fix">The Databricks fix</h3>

<p>Now I’m working for <a href="https://databricks.com/">Databricks</a>, which is aiming to solve this problem by making starting and sharing data science easier.</p>

<p>We doing it by harnessing the power of <a href="http://spark.apache.org/">Apache Spark</a>, a free and open-source tool for high-speed data processing created by our founders that, for the most the part, is only used by super nerds.</p>

<p>Over the last 8 months, the Databricks team has been hard at work integrating Spark into a free <a href="https://community.cloud.databricks.com/">community edition</a> where,  thanks to the power of cloud computing, even beginners can quickly import, transform and analyze gigantic data files using only their web browser.</p>

<h3 id="take-a-test-drive-today">Take a test drive today</h3>

<p>When the California Civic Data Coalition <a href="http://www.californiacivicdata.org/2016/09/15/website-launch/">announced last month</a> it was launching an API for accessing the latest data from the state’s campaign finance database, I realized that our new <a href="https://docs.cloud.databricks.com/docs/latest/databricks_guide/01%20Databricks%20Overview/03%20Notebooks.html">Databricks notebook</a> could make it easy for users to get started querying the data without having to install any software.</p>

<p>The Databricks notebook is an interactive workspace — similar to the <a href="http://www.californiacivicdata.org/2016/10/08/first-python-notebook/">Jupyter Notebook</a> — where you can use your browser to code and collaborate in an easy-to-use environment that leverages our powerful Spark backend. You can see <a href="https://databricks.com/resources/type/example-notebooks">numerous examples</a> on our site, or watch <a href="https://vimeo.com/137874931">the following introductory video</a>.</p>

<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; margin:12px 0; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>

<div class="embed-container">
<iframe src="https://player.vimeo.com/video/137874931?byline=0&amp;portrait=0" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe></div>
<div style="padding: 4px 0; clear:both; display:block;"></div>

<p>What’s amazing about Spark is that it can turn any structured files into an immediately queryable database. And the <a href="http://calaccess.californiacivicdata.org/documentation/">CAL-ACCESS</a> database that is cleaned and served by the California Civic Data Coalition is no different.</p>

<p>To see it in action, all you have to do is make an account and clone my <a href="https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/346304/3910054895802185/484361/latest.html">Databricks notebook</a> that downloads data from the Coalition’s API, racks it up with Spark and starts in on analysis. Instructions on how to make your copy are <a href="https://docs.databricks.com/user-guide/notebooks/index.html#importing-notebooks">here</a>.</p>

<figure style="margin: 8px 0;">
    <a href="https://databricks-prod-cloudfront.cloud.databricks.com/public/4027ec902e239c93eaaa8714f173bcfc/346304/3910054895802185/484361/latest.html">
        <img width="100%" src="/img/databricks-notebook.png" />
    </a>
    <figcaption>Bill's CAL-ACCESS notebook in action</figcaption>
</figure>

<p>Then push the “run” button and the notebook will automatically download and import the state’s sprawling database. In mere minutes it will be available for exploration using SQL and other tools.</p>

<p>I’ve already used it to take a rough cut at the biggest lobbying payments in the data. What can you find?</p>

            <script type="text/javascript">
                var url = window.location;
                // Will only work if string in href matches with location
                $('ul.nav a[href="/archive/"]').parent().addClass('active');
                // Will also work for relative and absolute hrefs
                $('ul.nav a').filter(function() {
                    return this.href == url;
                }).parent().addClass('active');
                $("#small-icon").css("cursor", "pointer");
                $("#small-icon").click(function () {
                    window.location = '/';
                });
            </script>
            </div>
        </div>
    </div>
    </article>
    <footer class="footer" aria-label="Footer">
  <nav class="container">
    <div class="row icon">
      <a href="http://www.californiacivicdata.org/">
        <img src="//calaccess.californiacivicdata.org/static/calaccess_website/images/white-geobear.svg"
             alt="California Civic Data Coalition logo">
      </a>
    </div>
    <div class="row">
      <section class="col-md-2 col-md-offset-1 col-sm-5 col-sm-offset-1 col-xs-5 col-xs-offset-1">
        <h3>CAL-ACCESS</h3>
        <ul>
            <li><a href="http://calaccess.californiacivicdata.org/downloads/latest/">Latest downloads</a></li>
            <li><a href="http://calaccess.californiacivicdata.org/downloads/">Downloads archive</a></li>
            <li><a href="http://calaccess.californiacivicdata.org/documentation/">Documentation</a></li>
        </ul>
      </section>
      <section class="col-md-2 col-md-offset-1 col-sm-5 col-sm-offset-1 col-xs-4 col-xs-offset-2">
        <h3>Blog</h3>
        <ul>
          <li><a href="http://www.californiacivicdata.org/archive/">All posts</a></li>
          <li><a href="http://www.californiacivicdata.org/archive/latest.xml">RSS</a></li>
        </ul>
      </section>
      <div class="clearfix visible-sm visible-xs"></div>
      <section class="col-md-2 col-md-offset-1 col-sm-5 col-sm-offset-1 col-xs-5 col-xs-offset-1">
        <h3>About</h3>
        <ul>
          <li><a href="https://www.californiacivicdata.org/about/">Our story</a></li>
          <li><a href="https://www.californiacivicdata.org/about/#team">The team</a></li>
          <li><a href="https://www.californiacivicdata.org/about/#events">Events</a></li>
          <li><a href="https://www.californiacivicdata.org/about/#what-others-are-saying">What others are saying</a></li>
        </ul>
      </section>
      <section class="col-md-2 col-md-offset-1 col-sm-5 col-sm-offset-1 col-xs-4 col-xs-offset-2">
        <h3>Contact</h3>
        <ul>
          <li><a href="mailto:cacivicdata@gmail.com">E-mail</a></li>
          <li><a href="https://github.com/california-civic-data-coalition">GitHub</a></li>
          <li><a href="https://newsnerdery.slack.com/archives/C0H8Y2QBD">Slack</a></li>
        </ul>
      </section>
    </div>
    <section class="row xs-left">
      <p>
        &copy; <span class="easteregg"><a href="https://www.youtube.com/watch?v=wPsA3TsK1Uk">2016 'til infinity</a></span>
        <span><a href="https://www.californiacivicdata.org/">California Civic Data Coalition</a>.</span>
        <span><span class="easteregg"><a href="https://en.wikipedia.org/wiki/Gratis_versus_libre">Gratis, libre and fermented</a></span> on <a href="https://github.com/california-civic-data-coalition/">GitHub</a>.</span>
        <span class="easteregg"><a href="https://www.youtube.com/watch?v=wKgGXxoT5Ds">Westside right on time only thing fosho</a>.</span>
      </p>
    </section>
  </nav>
</footer>

</body>
</html>
